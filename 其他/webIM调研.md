<font face="微软雅黑" size="4" >
<font size="6">web即时通信</font>


## 1 web即时通信的几种方式

目前有四种方式：短轮询、Comet、Websocket、SSE

### 1.1  客户端轮询（polling）  
通过ajax定时发送请求，缺点：无效请求太多

### 1.2  Comet 基于 HTTP 长连接的"服务器推"技术
#### 1.2.1 ajax长轮询（long-polling）  
客户端向服务器发送Ajax请求，服务器接到请求后hold住连接，直到有新消息才返回响应信息并关闭连接，客户端处理完响应信息后再向服务器发送新的请求。但是由于http是短连接，这个http消息连接最多被夯住90秒，就会被断开，此时重新建立链接，这个相比短轮询有效减少了服务器压力

#### 1.2.2 http-stream通信  
1.  基于XHR对象的streaming方式: readyState为3(表示通信过程还没有结束)的时候，获取它的responseText然后进行处理，直到readyState为4的时候才表示数据发送完毕，一次通信过程结束。在这个过程中，服务端传给客户端的数据是分多次以stream的形式发送给客户端，客户端也是通过stream形式来获取的。
2. iframe的数据流通信方式： 在浏览器中动态载入一个iframe,让它的src属性指向请求的服务器的URL，在浏览器端创建一个处理数据的函数，在服务端通过iframe与浏览器的长连接定时输出数据给客户端，但是这个返回的数据并不是一般的数据，而是插入一段script脚本。
3. 基于htmlfile的数据流通信，略。
### 1.3 Websocket
在HTML5中提供了websocket技术，它不仅是一种web通信方式，也是一种应用层协议。它提供了浏览器和服务器之间原生的双全工跨域通信，通过浏览器和服务器之间建立websocket连接（实际上是TCP连接）,在同一时刻能够实现客户端到服务器和服务器到客户端的数据发送。

### 1.4 SSE（服务器推送事件（Server-sent Events）

HTML5提供了一种新的技术叫做服务器推送事件SSE，它能够实现客户端请求服务端，然后服务端利用与客户端建立的这条通信连接push数据给客户端，客户端接收数据并处理的目的。

##  参考资料

1. [史上最全Web端即时通讯技术原理详解](http://blog.csdn.net/softwave/article/details/51943699)


